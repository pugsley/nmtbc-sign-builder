=IF(D4="wayfinding","https://pugsley.github.io/nmtbc-sign-builder/?data="&ENCODEURL("{""signType"":""wayfinding"",""trailName"":"""&SUBSTITUTE(E4,CHAR(10),"\n")&""",""grade"":"&VALUE(RIGHT(F4,1))&",""gradeNote"":"""&H4&""",""distance"":"""&I4&""",""distanceType"":"""&K4&""",""latitude"":"&IF(L4<>"",L4,0)&",""longitude"":"&IF(M4<>"",M4,0)&",""arrowDirection"":"""&IF(G4="","N",G4)&""",""bike"":"&IF(ISNUMBER(SEARCH("bike",LOWER(J4))),"true","false")&",""walk"":"&IF(ISNUMBER(SEARCH("walk",LOWER(J4))),"true","false")&",""logoToggles"":{""ncc"":true,""koata"":true,""nmtbc"":true}}"),IF(D4="smallwayfinding","https://pugsley.github.io/nmtbc-sign-builder/?data="&ENCODEURL("{""signType"":""smallwayfinding"",""trailName"":"""&SUBSTITUTE(E4,CHAR(10),"\n")&""",""background"":"&IF(ISNUMBER(SEARCH("nograde",SUBSTITUTE(LOWER(F4)," ",""))),"""nograde""",IF(ISNUMBER(SEARCH("warning",LOWER(F4))),"""warning""",IF(ISNUMBER(SEARCH("danger",LOWER(F4))),"""danger""",VALUE(RIGHT(F4,1)))))&",""activityDescription"":"""&K4&""""&IF(G4<>"",",""arrowDirection"":"""&G4&"""","")&IF(L4<>"",",""latitude"":"&L4,"")&IF(M4<>"",",""longitude"":"&M4,"")&",""printGuides"":false}"),"Unknown sign type"))